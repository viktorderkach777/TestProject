
 
pipeline {


agent any 
  parameters {
        string(name: 'TestCategory', defaultValue: 'Login', description: 'Enter the testcategory')
    }

environment {
act = 'mmmmmmm'
act2 = 'act2'
isTriggeredByGit = ''
dotnet = '/usr/share/dotnet/dotnet'
isTestCategoryLengthEqualsNull=''

}

stages {  

stage('Checkout') {

steps {

checkout scm


}

}

stage('Restore Packages') {

steps {

dir("awesome-project") {

sh "ls -la"

sh "pwd"

sh 'dotnet --info'

sh 'dotnet restore'

}

}

}

stage('DotNet Test') {

steps {

dir("awesome-project") {

sh "ls -la"

sh "pwd"
  script {
               act = currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')!= null
               act2 = currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')
               isTriggeredByGit = act2.toString().equals("[]")
               isTestCategoryLengthEqualsNull = (params.TestCategory).trim().length().equals("0")
          }
echo "${currentBuild.getBuildCauses('jenkins.branch.BranchEventCause')}"   
echo "${currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')}" 

sh 'dotnet --info'

  echo "${params.TestCategory}" 
   echo "${act}" 
   echo "${act2}" 
   echo "isTriggeredByGit = ${isTriggeredByGit}" 
  echo "${currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')}" 
  echo "isTestCategoryLengthEqualsNull = ${isTestCategoryLengthEqualsNull}"
}

}

}  
 
  
  stage('User2Feater1') {

       when {               
                expression { return branch 'User1Feature1' || branch 'dev' }
            }
       steps {
                echo '----User2Feater1-----'
            }
   }

stage('Example Deploy') {
            when {
                triggeredBy 'SCMTrigger'
            }
            steps {
                echo "============SCMTrigger==========================="
            }
        }


}

}
