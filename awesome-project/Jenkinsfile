
 
pipeline {


agent any 
  parameters {
        string(name: 'TestCategory', defaultValue: 'Login', description: 'Enter the testcategory')
    }

environment {
act = 'mmmmmmm'
act2 = 'act2'
isTriggeredByGit = ''
dotnet = '/usr/share/dotnet/dotnet'
isTestCategoryLengthEqualsNull=''

}

stages {  

stage('Checkout') {

steps {
  script {
               act = currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')!= null
               act2 = currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')
               isTriggeredByGit = act2.toString().equals("[]")
               isTestCategoryLengthEqualsNull = (params.TestCategory).trim().length() == 0
          }
    when {               
                //expression { return env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev'}
                expression { return (isTriggeredByGit == true && (env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev')) == false}
            }
       steps {
                echo '----GitforNotDevNotMaster-----'
                checkout scm
            }
  

        }
  }

stage('Restore Packages') {

steps {

dir("awesome-project") {

sh "ls -la"

sh "pwd"

//sh 'dotnet --info'

//sh 'dotnet restore'

}

}

}

stage('DotNet Test') {

steps {

 
 
dir("awesome-project") {

sh "ls -la"

sh "pwd"
 
echo "${currentBuild.getBuildCauses('jenkins.branch.BranchEventCause')}"   
echo "${currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')}" 

//sh 'dotnet --info'

  echo "${params.TestCategory}" 
   echo "${act}" 
   echo "${act2}" 
   echo "isTriggeredByGit = ${isTriggeredByGit}" 
  echo "${currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')}" 
  echo "isTestCategoryLengthEqualsNull = ${isTestCategoryLengthEqualsNull}"
}

}

}  
 
  
  stage('NotMasterNotDevNotGitNotParam') {

       when {               
                //expression { return env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev'}
                expression { return isTriggeredByGit == false && isTestCategoryLengthEqualsNull == true && (env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev')}
            }
       steps {
                echo '----NotMasterNotDevNotGitNotParam-----'
            }
   }
 stage('NotMasterNotDevNotGitParam') {

       when {               
                //expression { return env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev'}
                expression { return isTriggeredByGit == false && isTestCategoryLengthEqualsNull == false && (env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev')}
            }
       steps {
                echo '----NotMasterNotDevNotGitParam-----'
            }
   }
 stage('NotMasterNotDevGit') {

       when {               
                //expression { return env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev'}
                expression { return isTriggeredByGit == true && (env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev')}
            }
       steps {
                echo '----NotMasterNotDevGit-----'
            }
   }
 stage('MasterDevGit') {

       when {               
                //expression { return env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev'}
                expression { return isTriggeredByGit == true && (env.BRANCH_NAME == 'master' || env.BRANCH_NAME == 'dev')}
            }
       steps {
                echo '----MasterDevGit-----'
            }
   }
  stage('MasterDevNotGitNoParam') {

       when {               
                //expression { return env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev'}
                expression { return isTriggeredByGit == false && isTestCategoryLengthEqualsNull == true && (env.BRANCH_NAME == 'master' || env.BRANCH_NAME == 'dev')}
            }
       steps {
                echo '----MasterDevNotGitNoParam-----'
            }
   }
  stage('MasterDevNotGitParam') {

       when {               
                //expression { return env.BRANCH_NAME != 'master' && env.BRANCH_NAME != 'dev'}
                expression { return isTriggeredByGit == false && isTestCategoryLengthEqualsNull == false && (env.BRANCH_NAME == 'master' || env.BRANCH_NAME == 'dev')}
            }
       steps {
                echo '----MasterDevNotGitParam-----'
            }
   }

           


}

}
